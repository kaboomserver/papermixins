package pw.kaboom.papermixins.mixin.fix.exploit.beehive_uncapped_bees;

import com.llamalad7.mixinextras.injector.wrapoperation.Operation;
import com.llamalad7.mixinextras.injector.wrapoperation.WrapOperation;
import com.mojang.serialization.Codec;
import net.minecraft.world.level.block.entity.BeehiveBlockEntity;
import net.minecraft.world.level.block.entity.BeehiveBlockEntity.Occupant;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;

import java.util.List;

@Mixin(BeehiveBlockEntity.Occupant.class)
public abstract class BeehiveBlockEntityOccupantMixin {
    @WrapOperation(method = "<clinit>",
            at = @At(value = "INVOKE", target = "Lcom/mojang/serialization/Codec;listOf()" +
                    "Lcom/mojang/serialization/Codec;", remap = false))
    private static Codec<List<Occupant>> listCodec$listOf(final Codec<Occupant> instance,
                                                          final Operation<Codec<List<Occupant>>> original) {
        return instance.sizeLimitedListOf(BeehiveBlockEntity.MAX_OCCUPANTS);
    }
}
