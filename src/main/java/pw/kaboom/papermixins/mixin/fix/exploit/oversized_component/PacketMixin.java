package pw.kaboom.papermixins.mixin.fix.exploit.oversized_component;

import com.llamalad7.mixinextras.injector.ModifyReturnValue;
import net.minecraft.network.protocol.Packet;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import pw.kaboom.papermixins.util.MixinConstants;

@Mixin(Packet.class)
public interface PacketMixin {
    // Doing a mixin on the individual packets and overriding the isSkippable method directly could lead to
    // conflicts with Paper itself, so it's better to do it this way.
    @ModifyReturnValue(method = "isSkippable", at = @At("RETURN"))
    private boolean isSkippable$overrideIgnored(final boolean original) {
        return original || MixinConstants.FAIL_IGNORED_PACKETS.contains(this.getClass());
    }
}
